<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>算法原理（PLA原理）及 Python 实现 | 研究生学测试的南航程序员</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="感知机是二类分类的线性分类模型，其输入为实例的特征向量，输出为实例的类别，取+1和-1。



感知机的数学表示首先，感知机的输入空间（特征空间）为 $x \subseteq R^{n}$，即 n 维向量空间，输出空间为 Y={+1,−1}，即 −1 代表反例，+1 代表正例。例如：输入 $x \in X$ 对应于输入空间 Rn 中的某个点，而输出 $y \in Y$ 表示该点所在的分类。需要">
<meta property="og:type" content="article">
<meta property="og:title" content="算法原理（PLA原理）及 Python 实现">
<meta property="og:url" content="http://yoursite.com/2017/06/13/算法原理（PLA原理）及-Python-实现/index.html">
<meta property="og:site_name" content="研究生学测试的南航程序员">
<meta property="og:description" content="感知机是二类分类的线性分类模型，其输入为实例的特征向量，输出为实例的类别，取+1和-1。



感知机的数学表示首先，感知机的输入空间（特征空间）为 $x \subseteq R^{n}$，即 n 维向量空间，输出空间为 Y={+1,−1}，即 −1 代表反例，+1 代表正例。例如：输入 $x \in X$ 对应于输入空间 Rn 中的某个点，而输出 $y \in Y$ 表示该点所在的分类。需要">
<meta property="og:image" content="http://ofhbt8uhx.bkt.clouddn.com/20170312094333631.png">
<meta property="og:image" content="http://ofhbt8uhx.bkt.clouddn.com/%E6%8D%95%E8%8E%B7.PNG">
<meta property="og:image" content="http://ofhbt8uhx.bkt.clouddn.com/Figure_1.png">
<meta property="og:image" content="http://ofhbt8uhx.bkt.clouddn.com/Figure_1-1.png">
<meta property="og:image" content="http://ofhbt8uhx.bkt.clouddn.com/Figure_21.png">
<meta property="og:updated_time" content="2017-06-13T13:11:17.208Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="算法原理（PLA原理）及 Python 实现">
<meta name="twitter:description" content="感知机是二类分类的线性分类模型，其输入为实例的特征向量，输出为实例的类别，取+1和-1。



感知机的数学表示首先，感知机的输入空间（特征空间）为 $x \subseteq R^{n}$，即 n 维向量空间，输出空间为 Y={+1,−1}，即 −1 代表反例，+1 代表正例。例如：输入 $x \in X$ 对应于输入空间 Rn 中的某个点，而输出 $y \in Y$ 表示该点所在的分类。需要">
<meta name="twitter:image" content="http://ofhbt8uhx.bkt.clouddn.com/20170312094333631.png">
  
    <link rel="alternative" href="/atom.xml" title="研究生学测试的南航程序员" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <script src="/style.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  

</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="http://ofhbt8uhx.bkt.clouddn.com/home.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">唐杰</a></h1>
		</hgroup>

		
		<p class="header-subtitle">我也不知道为什么</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/photo.html">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">友链</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="3" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="#" title="github">github</a>
		        
					<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
		        
					<a class="rss" target="_blank" href="#" title="rss">rss</a>
		        
					<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">唐杰</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="http://ofhbt8uhx.bkt.clouddn.com/home.jpg" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">唐杰</h1>
			</hgroup>
			
			<p class="header-subtitle">我也不知道为什么</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/photo.html">随笔</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        <article id="post-算法原理（PLA原理）及-Python-实现" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      算法原理（PLA原理）及 Python 实现
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<blockquote>
<p>感知机是二类分类的线性分类模型，其输入为实例的特征向量，输出为实例的类别，取+1和-1。</p>
</blockquote>
<div align="center"><br><img src="http://ofhbt8uhx.bkt.clouddn.com/20170312094333631.png" alt=""><br></div>

<h2 id="感知机的数学表示"><a href="#感知机的数学表示" class="headerlink" title="感知机的数学表示"></a>感知机的数学表示</h2><p><strong>首先，感知机的输入空间（特征空间）为 $x \subseteq R^{n}$，即 n 维向量空间，输出空间为 Y={+1,−1}，即 −1 代表反例，+1 代表正例。例如：输入 $x \in X$ 对应于输入空间 Rn 中的某个点，而输出 $y \in Y$ 表示该点所在的分类。需要注意的是，输入 x 是一个 n 维的向量，即 x=(x(1),x(2),…,x(n))。现在已经有了输入和输出的定义，我们就可以给出感知机 f(x) 的模型了： </strong><br>$$f(x) = \ sign(\omega \cdot x+b)$$<br><strong>其中，向量 ω=(ω(1),ω(2),…,ω(n)) 中的每个分量代表输入向量空间 $R^{n}$ 中每个分量 $x_i$的权重，或者说参数。$b \in R$称为偏置单元，ω⋅x 表示 ω 和 x的内积，sign 是一个符号函数，即： </strong></p>
<div align="center"><br><img src="http://ofhbt8uhx.bkt.clouddn.com/%E6%8D%95%E8%8E%B7.PNG" alt=""><br></div>

<p><strong>我们把上面这个函数 f(x) 称为感知机。</strong><br><a id="more"></a></p>
<h2 id="PLA原理"><a href="#PLA原理" class="headerlink" title="PLA原理"></a>PLA原理</h2><p><strong>PLA 的原理很简单，开始时，我们令 ω=b=0，然后在训练数据 D 中任意选择一点，如果该点被错误分类了，那么我们就调整分类的直线或者超平面使该点能够被正确分类。</strong></p>
<p><strong>在说明 PLA 原理之前，我们先来回顾一下向量的内积（inner product）。例如有向量 a=(a(1),a(2),…,a(n)),b=(b(1),b(2),…,b(n))，则它们的内积为： </strong><br>$$a \cdot b=\sum_{i=1}^{n} a^{(i)}b^{i}=\Arrowvert a \Arrowvert \cdot \Arrowvert b \Arrowvert \cdot \cos \theta$$<br><strong>在纸上画画就明白，当内积为负数时，两个向量的夹角 θ 大于 90°；当内积为正数时，两个向量的夹角 θ 小于 90°；当内积为 0 时，两个向量垂直。</strong><br><strong>方程 ω⋅x+b=0 代表了一个平面。我们不妨将其改写为$\hat{\omega} \cdot \hat{x} =0$ ，其中： </strong><br>$$\hat{\omega}=(b,\omega)=(\omega^{0},\omega)=(\omega^{(0)},\omega^{(1)},\omega^{(2)},…,\omega^{(n)}) $$<br>$$\hat{x}=(1,x)=(1,x^{(1)},x^{(2)},…,x^{(n)}) $$<br><strong>我们的目的就是求得超平面的法向量 ω^， 使超平面能够完美地划分数据集。</strong></p>
<p><strong>具体怎么求呢，我们采用随机梯度下降法，即随意找一个点，如果分类错误，我们就更新 $\hat{\omega}$：</strong></p>
<ul>
<li><strong>输入数据 $D=(x_1,y_1),(x_2,y_2),…,(x_m,y_m)$，其中 $x_i\in X\subset R_n$，$y\in Y={+1,−1}，i=1,2,…,n$。</strong></li>
<li><strong>选取初值 $\hat{\omega}_0= 0$，即设为零向量。</strong></li>
<li><strong>遍历 $D$ 中的数据，如果遇到某个样本$ (x_i,y_i)$ 使得 $y_i(\hat{\omega}\cdot x)\leq 0$，即目前分类输出和真实分类不同，则</strong><br>$$\hat{\omega}\leftarrow \hat{\omega_0}+y_i\hat{x}_i$$</li>
<li>$\hat{\omega}$ 更新后，回到第三步，重新开始遍历，如果遍历完整个数据集 $D$ 都未有更新操作（没有错误分类点），则转第五步。</li>
<li>输出当前超平面的法向量 $\hat{\omega}$。</li>
</ul>
<p><strong>最后程序输出的 $\hat{\omega}$ 即为我们要找的能够完美划分数据集的超平面的法向量。</strong></p>
<h2 id="python-代码"><a href="#python-代码" class="headerlink" title="python 代码"></a>python 代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="string">'''</span></div><div class="line">Created on 2017年6月13日</div><div class="line">感知器算法</div><div class="line">@author: 唐杰</div><div class="line">'''</div><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> matplotlib</div><div class="line">myfont = matplotlib.font_manager.FontProperties(fname=<span class="string">r'F:/Anaconda3/envs/tensorflow/Lib/site-packages/matplotlib/mpl-data/fonts/ttf/msyh.ttc'</span>)</div><div class="line"></div><div class="line"><span class="string">'''</span></div><div class="line">weights [2,3] numLines 5为例</div><div class="line">下面方法随机产生线性可分的数据集</div><div class="line">'''</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeLinearSeparableDeta</span><span class="params">(weights,numLines)</span>:</span><span class="comment">#weights [2,3]</span></div><div class="line">    w=array(weights)<span class="comment">#用来产生分类直线的法向量[2,3]，列表转换为数组</span></div><div class="line">    numFeatures=len(weights)<span class="comment">#法向量的特征数，在几维空间</span></div><div class="line">    dataSet=zeros((numLines,numFeatures+<span class="number">1</span>))<span class="comment">#创建5*3的数据集</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numLines):</div><div class="line">        x = random.rand(<span class="number">1</span>, numFeatures) * <span class="number">20</span> - <span class="number">10</span><span class="comment">#创建一个1*2的矩阵，元素范围在-10~10</span></div><div class="line">        innerProduct = sum(w * x)<span class="comment">#法向量与随机点进行内积判断正负，从而分类</span></div><div class="line">        <span class="keyword">if</span> innerProduct &lt;= <span class="number">0</span>:</div><div class="line">            dataSet[i] = append(x, <span class="number">-1</span>)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            dataSet[i] = append(x, <span class="number">1</span>)</div><div class="line">    <span class="keyword">return</span> dataSet</div><div class="line"></div><div class="line"><span class="string">'''</span></div><div class="line">数据可视化</div><div class="line">'''</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plotdata</span><span class="params">(dataSet)</span>:</span></div><div class="line">    ax=plt.subplot(<span class="number">111</span>)</div><div class="line">    plt.title(<span class="string">'线性可分数据集'</span>,fontproperties=myfont, fontsize=<span class="number">19</span>)</div><div class="line">    plt.xlabel(<span class="string">'X'</span>)</div><div class="line">    plt.ylabel(<span class="string">'Y'</span>)</div><div class="line">    labels = array(dataSet[:,<span class="number">2</span>])<span class="comment">#分类标签</span></div><div class="line">    idx_1 = where(dataSet[:,<span class="number">2</span>]==<span class="number">1</span>)<span class="comment">#找到正例行的下标</span></div><div class="line">    p1 = ax.scatter(dataSet[idx_1,<span class="number">0</span>], dataSet[idx_1,<span class="number">1</span>], marker=<span class="string">'o'</span>, color=<span class="string">'g'</span>, label=<span class="number">1</span>, s=<span class="number">20</span>)</div><div class="line">    idx_2 = where(dataSet[:,<span class="number">2</span>]==<span class="number">-1</span>)</div><div class="line">    p2 = ax.scatter(dataSet[idx_2,<span class="number">0</span>], dataSet[idx_2,<span class="number">1</span>], marker=<span class="string">'x'</span>, color=<span class="string">'r'</span>, label=<span class="number">2</span>, s=<span class="number">20</span>)</div><div class="line">    plt.legend(loc = <span class="string">'upper right'</span>)</div><div class="line">    plt.show()</div><div class="line"></div><div class="line"><span class="string">'''</span></div><div class="line">训练感知机</div><div class="line">'''  </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(dataSet,plot=False)</span>:</span></div><div class="line">    numLines=dataSet.shape[<span class="number">0</span>]<span class="comment">#返回数组第一维的个数</span></div><div class="line">    numFeatures = dataSet.shape[<span class="number">1</span>]</div><div class="line">    w = zeros((<span class="number">1</span>, numFeatures - <span class="number">1</span>))         <span class="comment"># initialize weights</span></div><div class="line">    separated = <span class="keyword">False</span></div><div class="line">    </div><div class="line">    i = <span class="number">0</span>;</div><div class="line">    <span class="comment">#下面的方法是梯度下降法</span></div><div class="line">    <span class="comment">#判断y*(w*x) 如果&lt;=0 w=w+y*x</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">not</span> separated <span class="keyword">and</span> i &lt; numLines:</div><div class="line">        <span class="keyword">if</span> dataSet[i][<span class="number">-1</span>] * sum(w * dataSet[i,<span class="number">0</span>:<span class="number">-1</span>]) &lt;= <span class="number">0</span>:</div><div class="line">            w = w + dataSet[i][<span class="number">-1</span>] * dataSet[i,<span class="number">0</span>:<span class="number">-1</span>]</div><div class="line">            separated = <span class="keyword">False</span></div><div class="line">            i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            i += <span class="number">1</span>       </div><div class="line">    <span class="keyword">if</span> plot == <span class="keyword">True</span>:</div><div class="line">        <span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line">        <span class="keyword">from</span> matplotlib.lines <span class="keyword">import</span> Line2D</div><div class="line">        fig = plt.figure()</div><div class="line">        ax = fig.add_subplot(<span class="number">111</span>)</div><div class="line">        ax.set_title(<span class="string">'Linear separable data set'</span>)</div><div class="line">        plt.xlabel(<span class="string">'X'</span>)</div><div class="line">        plt.ylabel(<span class="string">'Y'</span>)</div><div class="line">        labels = array(dataSet[:,<span class="number">2</span>])</div><div class="line">        idx_1 = where(dataSet[:,<span class="number">2</span>]==<span class="number">1</span>)</div><div class="line">        p1 = ax.scatter(dataSet[idx_1,<span class="number">0</span>], dataSet[idx_1,<span class="number">1</span>], </div><div class="line">            marker=<span class="string">'o'</span>, color=<span class="string">'g'</span>, label=<span class="number">1</span>, s=<span class="number">20</span>)</div><div class="line">        idx_2 = where(dataSet[:,<span class="number">2</span>]==<span class="number">-1</span>)</div><div class="line">        p2 = ax.scatter(dataSet[idx_2,<span class="number">0</span>], dataSet[idx_2,<span class="number">1</span>], </div><div class="line">            marker=<span class="string">'x'</span>, color=<span class="string">'r'</span>, label=<span class="number">2</span>, s=<span class="number">20</span>)</div><div class="line"><span class="comment">#        x = w[0][0] / abs(w[0][0]) * 10</span></div><div class="line"><span class="comment">#        y = w[0][1] / abs(w[0][0]) * 10</span></div><div class="line"><span class="comment">#        ann = ax.annotate("",xy=(x,y),xytext=(0,0),size=20, arrowprops=dict(arrowstyle="-|&gt;"))</span></div><div class="line">        ys = (<span class="number">-12</span> * (-w[<span class="number">0</span>][<span class="number">0</span>]) / w[<span class="number">0</span>][<span class="number">1</span>], <span class="number">12</span> * (-w[<span class="number">0</span>][<span class="number">0</span>]) / w[<span class="number">0</span>][<span class="number">1</span>])</div><div class="line">        ax.add_line(Line2D((<span class="number">-12</span>, <span class="number">12</span>), ys, linewidth=<span class="number">1</span>, color=<span class="string">'blue'</span>))</div><div class="line">        plt.legend(loc = <span class="string">'upper right'</span>)</div><div class="line">        plt.show()</div><div class="line">          </div><div class="line">    <span class="keyword">return</span> w     </div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="comment">#x=makeLinearSeparableDeta([2,3],5)</span></div><div class="line">    x=makeLinearSeparableDeta([<span class="number">2</span>,<span class="number">3</span>],<span class="number">80</span>)</div><div class="line">    print(x)</div><div class="line">    plotdata(x)</div><div class="line">    train(x,<span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<p><strong>以上代码得到的结果为：</strong></p>
<div align="center"><br><img src="http://ofhbt8uhx.bkt.clouddn.com/Figure_1.png" alt=""><br></div><br><div align="center"><br><img src="http://ofhbt8uhx.bkt.clouddn.com/Figure_1-1.png" alt=""><br></div><br>## 利用lris数据集的python 代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="string">'''</span></div><div class="line">Created on 2017年6月13日</div><div class="line">感知器算法 实现2</div><div class="line">@author: 唐杰</div><div class="line">'''</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Perceptron</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="comment">#eta表示学习率0~0.1之间  n_iter迭代次数</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, eta=<span class="number">0.01</span>, n_iter=<span class="number">10</span>)</span>:</span></div><div class="line">        self.eta = eta</div><div class="line">        self.n_iter = n_iter</div><div class="line">    <span class="comment">#X训练数据集[samples,features] Y目标值[samples]   </span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, X, y)</span>:</span></div><div class="line">        self.w_ = np.zeros(<span class="number">1</span> + X.shape[<span class="number">1</span>]) <span class="comment"># 权重</span></div><div class="line">        self.errors_=[]</div><div class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(self.n_iter):</div><div class="line">            errors = <span class="number">0</span></div><div class="line">            <span class="keyword">for</span> xi, target <span class="keyword">in</span> zip(X, y):<span class="comment">#zip函数接受任意多个（包括0个和1个）序列作为参数，返回一个tuple列表</span></div><div class="line">                update = self.eta * (target - self.predict(xi))</div><div class="line">                self.w_[<span class="number">1</span>:] += update * xi</div><div class="line">                self.w_[<span class="number">0</span>] += update</div><div class="line">                errors += int(update != <span class="number">0.0</span>)</div><div class="line">            self.errors_.append(errors)</div><div class="line">        <span class="keyword">return</span> self</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">net_input</span><span class="params">(self,X)</span>:</span></div><div class="line">        <span class="keyword">return</span> np.dot(X,self.w_[<span class="number">1</span>:])+self.w_[<span class="number">0</span>]</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self,X)</span>:</span></div><div class="line">        <span class="keyword">return</span> np.where(self.net_input(X)&gt;=<span class="number">0.0</span>,<span class="number">1</span>,<span class="number">-1</span>)</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> matplotlib.colors <span class="keyword">import</span> ListedColormap</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_decision_region</span><span class="params">(X,y,classifier,resolution=<span class="number">0.02</span>)</span>:</span></div><div class="line">    markers=(<span class="string">'s'</span>,<span class="string">'x'</span>,<span class="string">'o'</span>,<span class="string">'^'</span>,<span class="string">'v'</span>)</div><div class="line">    colors=(<span class="string">'red'</span>,<span class="string">'blue'</span>,<span class="string">'lightgreen'</span>,<span class="string">'gray'</span>,<span class="string">'cyan'</span>)</div><div class="line">    cmap=ListedColormap(colors[:len(np.unique(y))])</div><div class="line">    </div><div class="line">    x1_min,x1_max=X[:,<span class="number">0</span>].min()<span class="number">-1</span>,X[:,<span class="number">0</span>].max()+<span class="number">1</span></div><div class="line">    x2_min,x2_max=X[:,<span class="number">1</span>].min()<span class="number">-1</span>,X[:,<span class="number">1</span>].max()+<span class="number">1</span></div><div class="line">    </div><div class="line">    xx1,xx2=np.meshgrid(np.arange(x1_min,x1_max,resolution),</div><div class="line">                        np.arange(x2_min,x2_max,resolution))</div><div class="line">    Z=classifier.predict(np.array([xx1.ravel(),xx2.ravel()]).T)</div><div class="line">    Z=Z.reshape(xx1.shape)</div><div class="line">    </div><div class="line">    plt.contourf(xx1,xx2,Z,alpha=<span class="number">0.4</span>,cmap=cmap)</div><div class="line">    plt.xlim(xx1.min(),xx1.max())</div><div class="line">    plt.ylim(xx2.min(),xx2.max())</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> idx,cl <span class="keyword">in</span> enumerate(np.unique(y)):</div><div class="line">        plt.scatter(x=X[y==cl,<span class="number">0</span>], y=X[y==cl,<span class="number">1</span>], alpha=<span class="number">0.8</span>, c=cmap(idx), marker=markers[idx], label=cl)</div><div class="line">    </div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:  </div><div class="line">    <span class="comment">#pandas读取csv文件，header=none表示原始文件没有列索引需要自己加上  </span></div><div class="line">    df=pd.read_csv(<span class="string">'http://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data'</span>,header=<span class="keyword">None</span>)</div><div class="line">    <span class="comment">#print(df.tail())#显示后五条的记录</span></div><div class="line">    y=df.iloc[<span class="number">0</span>:<span class="number">100</span>,<span class="number">4</span>].values<span class="comment">#类别标记</span></div><div class="line">    y=np.where(y==<span class="string">'Iris-setosa'</span>,<span class="number">-1</span>,<span class="number">1</span>)</div><div class="line">    X=df.iloc[<span class="number">0</span>:<span class="number">100</span>,[<span class="number">0</span>,<span class="number">2</span>]].values</div><div class="line">    idx_1 = where(y[:]==<span class="number">-1</span>)</div><div class="line">    idx_2 = where(y[:]==<span class="number">1</span>)</div><div class="line">    plt.figure()</div><div class="line">    plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)</div><div class="line">    plt.scatter(X[idx_1,<span class="number">0</span>], X[idx_1,<span class="number">1</span>],color=<span class="string">'r'</span>,marker=<span class="string">'o'</span>,label=<span class="string">'setosa'</span>)</div><div class="line">    plt.scatter(X[idx_2,<span class="number">0</span>], X[idx_2,<span class="number">1</span>],color=<span class="string">'b'</span>,marker=<span class="string">'x'</span>,label=<span class="string">'versicolor'</span>)</div><div class="line">    plt.xlabel(<span class="string">'petal length'</span>)</div><div class="line">    plt.ylabel(<span class="string">'sepal length'</span>)</div><div class="line">    plt.legend(loc=<span class="string">'upper left'</span>)</div><div class="line">    <span class="comment">#plt.show()</span></div><div class="line">    plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>)</div><div class="line">    ppn=Perceptron(eta=<span class="number">0.1</span>,n_iter=<span class="number">10</span>)</div><div class="line">    ppn.fit(X, y)</div><div class="line">    print(ppn.errors_)</div><div class="line">    plt.plot(range(<span class="number">1</span>,len(ppn.errors_)+<span class="number">1</span>),ppn.errors_,marker=<span class="string">'o'</span>)</div><div class="line">    plt.xlabel(<span class="string">'Epoches'</span>)</div><div class="line">    plt.ylabel(<span class="string">'Number of misclassifications'</span>)</div><div class="line">    <span class="comment">#plt.show()</span></div><div class="line">    plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">    plot_decision_region(X,y,classifier=ppn)</div><div class="line">    plt.xlabel(<span class="string">'sepal length'</span>)</div><div class="line">    plt.ylabel(<span class="string">'petal length'</span>)</div><div class="line">    plt.legend(loc=<span class="string">'upper left'</span>)</div><div class="line">    plt.show()</div></pre></td></tr></table></figure><br><br><strong>以上代码得到的结果为：</strong><br><div align="center"><br><img src="http://ofhbt8uhx.bkt.clouddn.com/Figure_21.png" alt=""><br></div>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2017/06/13/算法原理（PLA原理）及-Python-实现/" class="archive-article-date">
  	<time datetime="2017-06-13T12:54:45.000Z" itemprop="datePublished"><i class="icon-clock"></i>2017-06-13</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/机器学习/">机器学习</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2017/06/14/自适应线性神经网络/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          自适应线性神经网络
        
      </div>
    </a>
  
  
    <a href="/2017/06/13/Python-matplotlib-数据可视化/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Python matplotlib 数据可视化</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>




<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">Share to: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
	    <a class="jiathis_button_twitter"></a>
	    <a class="jiathis_button_plus"></a> 
	    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?move=0&amp;uid=2117332" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>








<section id="comments">
  
    <!-- UY BEGIN -->
    <section id="comments">
        <div id="uyan_frame"></div>
        <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2117332"></script>
    </section>
    <!-- UY END -->

</section>


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 唐杰
    	</div>
      	<div class="footer-right">
      		
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
      <li data-hook="tools-section-friends"><span class="text">友链</span><i class="icon-link"></i></li>
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/Django/" style="font-size: 10px;">Django</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Hexo/" style="font-size: 12.5px;">Hexo</a> <a href="/tags/Java/" style="font-size: 17.5px;">Java</a> <a href="/tags/design-pattern/" style="font-size: 10px;">design pattern</a> <a href="/tags/diary/" style="font-size: 10px;">diary</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/人脸检测/" style="font-size: 15px;">人脸检测</a> <a href="/tags/数据库/" style="font-size: 12.5px;">数据库</a> <a href="/tags/数据结构/" style="font-size: 17.5px;">数据结构</a> <a href="/tags/机器学习/" style="font-size: 17.5px;">机器学习</a>
    			</div>
    	</section>
    

    
    	<section class="tools-section tools-section-friends">
  		
  			<div class="friends-wrap" id="js-friends">
  			
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="/Game1/index.html">猜拳游戏</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="/五子棋/index.html">五子棋</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="/Game2/index.html">俄罗斯方块</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="/Game3/index.html">是男人就下100层</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="/Game4/index.html">打飞机</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="/Game5/index.html">碰撞游戏</a>
  	        
  	        </div>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">很惭愧&lt;br&gt;&lt;br&gt;只做了一点微小的工作&lt;br&gt;谢谢大家</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>